# --- Enable Rewrite Engine ---
RewriteEngine On

# --- Cache Buster (global for all CSS & JS) ---
SetEnv CACHEBUST_VER "20251120-001"

<IfModule mod_rewrite.c>
    RewriteCond %{REQUEST_URI} \.(css|js)$ [NC]
    RewriteRule ^(.+)$ $1?v=%{ENV:CACHEBUST_VER} [QSA,L]
</IfModule>

# --- 1. Block direct access to sensitive files ---
RewriteRule ^config\.php$ - [F,L]
RewriteRule ^data/ - [F,L]

# --- 2. Protect admin area ---
# (Untouched)

# --- 3. Protect API folder ---
# RewriteRule ^api/ - [F,L]

# --- 4. Prevent directory browsing for uploads ---
# RewriteCond %{REQUEST_URI} ^/public/projects/
# RewriteRule ^.*$ - [R=403,L]

# --- 5. Default file for root ---
DirectoryIndex index.php

# --- 6. Extra: disable directory browsing globally ---
Options -Indexes